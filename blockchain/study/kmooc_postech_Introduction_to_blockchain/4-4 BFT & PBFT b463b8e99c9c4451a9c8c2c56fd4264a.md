# 4-4. BFT & PBFT

BFT 기반의 합의 알고리즘이 갖는 특징과 예시 

비젠틴 장군 문제

해결책 1. BFT

해결책 2. PBFT

어떤 합의 알고리즘이 네트워크에서 통용되기 위해 필요한 2가지 특성

- Safety
    - 노드 간 합의가 발생했다면, 어느 노드가 접근하든 그 값은 동일해야 한다
    - 블록체인의 finality와 유사
- Liveness
    - 합의 대상에 문제가 없다면, 네트워크 내에서 반드시 합의가 이루어진다
    - 비동기 네트워크내에서는 모두 완벽히 만족하는 합의 알고리즘을 설계하는 것은 불가능하다고 함 : FLP impossibility
        - 완벽할 수 없다

노드 간 합의를 이루는 새로운 분산 원장 합의 알고리즘

비잔틴 장군 문제 :

- 각 장군이 자신의 군대를 가지고 있음
- 공격하거나 후퇴하기 위해 합의해야 함
    - 각 장군은 공격 / 후퇴를 결정
    - 번복할 수 없음
    - 같은 결정을 해야 하고 동시에 시행해야 함
    - 전달자에 의해 전달되는 메시지를 통해서만 소통이 가능함
        - 문제 ? 메시지가 늦거나 전달되지 않고 소실될 가능성 존재
        - 또한 구성원이 악의적으로 행동할 가능성이 있고
        - 가짜 메시지를 보내 혼란 야기 가능성 있음
        

완전한 실패를 막기 위해 동일한 행동을 하기로 약속하고 실천해야 함

분산화 된 시스템에서 이러한 합의 달성을 위해 2/3 이상의 합의가 되어야 함

비잔틴 장애 허용 : 딜레마 막기 위함

- 일부 노드가 고장나거나 악의적으로 행동하더라도 해결할 수 있음
- 문제 해결을 위한 방법이 다양함
- BFT 이 장애 허용을 보통 합의 알고리즘이라고 부름
    
    

작업 증명, 지분 증명 등 여러개 방법이 있음

비잔틴 실패에 대한 가장 똑똑한 알고리즘 : 작업 증명

마이닝 과정, 암호화 기술

PBFT 

- saftey 확보, liveness 일부 포기
- 비동기 네트워크에서 배신자 노드가 f개 있을 때, 총 노드 개수가 3f+1개 이상이면 해당 네트워크에서 이루어지는 합의는 신뢰할 수 있다는 것을 수학적으로 증명
- 텐더민트 : PBFT + DPoS
    - propose, prevote, precommit
    - 각 라운드 마다 블록을 생성, 매 라운드에서 합의를 생성
- 이더리움 : Casper + PoW